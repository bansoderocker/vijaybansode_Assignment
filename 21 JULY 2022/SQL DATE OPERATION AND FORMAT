

--1		LIST empname, hiredate and the no of years completed by each employee in organization

SELECT ENAME,HIREDATE, DATEDIFF(YY,HIREDATE,GETDATE()) AS[COMPLETED YEARS] FROM EMP 


--2		LIST ALL EMP WHO HAVE JOINED BEFORE 2000
SELECT * FROM EMP WHERE YEAR(HIREDATE)< 2000


--3		LIST ALL EMP WHO HAVE COMPLETED 35 YEARS OF SERVICE

SELECT * , DATEDIFF(YY,HIREDATE,GETDATE()) AS[YEARS OF SERVICE] FROM EMP WHERE DATEDIFF(YY,HIREDATE,GETDATE())>= 35

--4		LIST ALL EMP AS PER THE MONTH OF JOINING IRRESPECITVE OF THE YEARS . EXAMPLE JAN, FEB .... DEC
SELECT * FROM EMP ORDER BY MONTH(HIREDATE) 

--5		LIST ALL EMP WHO HAVE JOINED IN DEC 81

SELECT * FROM EMP WHERE MONTH(HIREDATE)=12 AND YEAR(HIREDATE)= 1981

--6		LIST EACH YEAR   IN WHICH  EMP HAVE JOINED

SELECT DISTINCT YEAR(HIREDATE) AS [YEAR] FROM EMP

--7		For each employee display the number of days passed since the employee joined the company
SELECT ENAME,HIREDATE,DATEDIFF(DD,HIREDATE,GETDATE())AS [NUMBER OF DAYS PASSED] FROM EMP


--8		list empname, hiredate and dayoftheweek when employee joined the organization
SELECT ENAME,HIREDATE,DATENAME(DW,HIREDATE) as DAYOFTHEWEEK FROM EMP

--9		LIST THE YEAR AND TOTAL NO OF EMP JOINED IN THAT YEAR  
SELECT YEAR(HIREDATE) AS YEAR,COUNT (EMPNO) AS [JOIN EMP COUNT] FROM EMP GROUP BY YEAR(HIREDATE)
--HINT
-- 1981		3
-- 1985		5


--10	LIST ONLY THE YEAR WHERE MORE THEN 3 EMP JOINED
SELECT YEAR(HIREDATE) AS YEAR,COUNT (EMPNO) AS [JOIN EMP COUNT] FROM EMP GROUP BY YEAR(HIREDATE) HAVING COUNT (EMPNO)>3

--11	LIST FULL DETAILS OF OLDEST  EMPLOYEE
SELECT TOP 1 * FROM EMP ORDER BY HIREDATE 

--------------------------------------------------------------------------------
--12
--DISPLAY EMP NAME IN PROPER CASE (first char capital - rest all in small case)
--Smith
--Allen
--Ward

SELECT CONCAT(UPPER(LEFT(ENAME,1)),LOWER(RIGHT(ENAME,LEN(ENAME)-1))) as ENAME  FROM EMP

--13
--All employees who are not receiving commission are entitled  to Rs. 250 as an additional amount,  show the net earnings  of all employees

----- NOT Clear exacctly -- 2022-07-21 23:39:15.830
SELECT ENAME, JOB, SAL, ISNULL(COMM,250) AS COMM, SAL + ISNULL(COMM,250) AS NETSAL FROM EMP WHERE COMM IS NULL

--14
 ---- Display the name, job and bonus for all employees, 
 --assuming all managers gets a bonus of Rs. 500, 
 --clerk gets Rs. 200 
 --and all other except president get Rs. 350. 
 --The president gets 20% of his salary as bonus
 
 SELECT ENAME,JOB, 
 CASE JOB 
 WHEN 'MANAGER' THEN 500
 WHEN 'PRESIDENT' THEN SAL*0.2
 ELSE 350
 END   BONUS 
 FROM EMP 
 
 --------------------------------
--15	 Find the  job of the employees receiving commission
 select distinct job from emp where comm is null
 select job from emp where comm is null group by job
--16	 Show the daily salary of all employees assuming a month has 30 days without any decimal
SELECT EMPNO , ENAME,SAL,round(SAL/30,0) as roundSAL ,FLOOR(sal/30) as floorSAL,CEILING(sal/30) as ceilingSAL FROM EMP
 
--17	display record of last joined employee
SELECT TOP 1 * FROM EMP ORDER BY HIREDATE DESC

--18	list empname, hiredate, sal , comm and netsal in date, number and currency format of India  

SELECT ENAME,HIREDATE,FORMAT(SAL, 'C', 'HI-IN') AS SAL,FORMAT (COMM, 'c', 'hi-IN') as COMM, FORMAT (SAL + ISNULL(COMM,0), 'c', 'hi-IN') AS NETSAL FROM EMP

 
--19	CASE SENSITIVE
--IN MS SQL SERVER HOW TO WORK ON CASE SENSITIVE DATA

SELECT * FROM EMP WHERE ENAME = 'KING' --KING
SELECT * FROM EMP WHERE ENAME = 'King' --X
SELECT * FROM EMP WHERE ENAME = 'kING' --X
SELECT * FROM EMP WHERE ENAME = 'KinG' --X
SELECT * FROM EMP WHERE ENAME = 'kinG' --X


SELECT * FROM EMP WHERE CONVERT(VARBINARY, ENAME) = CONVERT(VARBINARY, 'KING') --KING
SELECT * FROM EMP WHERE CONVERT(VARBINARY, ENAME) = CONVERT(VARBINARY, 'King') --X
SELECT * FROM EMP WHERE CONVERT(VARBINARY, ENAME) = CONVERT(VARBINARY, 'kING') --X
SELECT * FROM EMP WHERE CONVERT(VARBINARY, ENAME) = CONVERT(VARBINARY, 'KinG') --X
SELECT * FROM EMP WHERE CONVERT(VARBINARY, ENAME) = CONVERT(VARBINARY, 'kinG') --X




--20

---IDENTITY INSERT
--INSERT VALUE IN THIS TABLE
--FIND OUT IDENTITY VALUE ADDED IN TABLE -- 
-- --INSERT MANUAL VALUE IN THIS TABLE
CREATE TABLE IDENTITYDEMO (
SQNO INT IDENTITY (1,1) PRIMARY KEY
)

SET IDENTITY_INSERT IDENTITYDEMO ON
INSERT INTO IDENTITYDEMO (SQNO)VALUES(1)
SELECT IDENT_CURRENT('IDENTITYDEMO') AS CURRENT_IDENTITY;  

INSERT INTO IDENTITYDEMO (SQNO)VALUES(20)
SELECT IDENT_CURRENT('IDENTITYDEMO') AS CURRENT_IDENTITY;  


INSERT INTO IDENTITYDEMO (SQNO)VALUES(40)
SELECT IDENT_CURRENT('IDENTITYDEMO') AS CURRENT_IDENTITY;  
